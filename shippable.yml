language: go

go:
   - 1.8

install:
   - go get -u github.com/golang/dep/cmd/dep
   - go install github.com/golang/dep/cmd/dep

build:
  ci:
    - dep ensure
    - export GOPATH=$PWD
    - export PATH=$PATH:$GOPATH/bin
    - export GOOS=linux
    - export GOARCH=amd64
    - go build -v -i -o docker/bin/k8s-monitor
    - cd docker
    - docker build -t danebarentine/k8s-monitor .
  post_ci:
    - docker commit $SHIPPABLE_CONTAINER_NAME danebarentine/k8s-monitor
    - docker push danebarentine/k8s-monitor

integrations:
    hub:
      - integrationName: docker-hub
        type: docker
        branches:
          only:
            - master